<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<title>Admin | Manage Users</title>

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
	rel="stylesheet">

<style>
body {
	background-color: #f8fafc;
	font-family: 'Segoe UI', sans-serif;
}

.dashboard-wrapper {
	display: flex;
	min-height: 100vh;
}

/* Sidebar */
.sidebar {
	width: 270px;
	background: linear-gradient(180deg, #991b1b, #7f1d1d);
	color: white;
	padding: 25px 20px;
	display: flex;
	flex-direction: column;
}

.sidebar h4 {
	font-weight: 700;
	margin-bottom: 35px;
}

.sidebar a {
	display: flex;
	align-items: center;
	gap: 12px;
	padding: 12px 15px;
	color: #fecaca;
	text-decoration: none;
	border-radius: 10px;
	margin-bottom: 10px;
	font-size: 0.95rem;
}

.sidebar a:hover, .sidebar a.active {
	background-color: rgba(255, 255, 255, 0.18);
	color: white;
}

.sidebar .logout {
	margin-top: auto;
	color: #fca5a5;
}

/* Content */
.content {
	flex-grow: 1;
	padding: 30px 35px;
}

.page-header h3 {
	font-weight: 700;
}

.table thead {
	background-color: #fee2e2;
}
</style>
</head>

<body>

	<div class="dashboard-wrapper">

		<!-- SIDEBAR -->
		<div class="sidebar">
			<h4>Fashion Store</h4>

			<a href="/admin/dashboard"> <i class="bi bi-speedometer2"></i>
				Dashboard
			</a> <a href="/admin/users" class="active"> <i class="bi bi-people"></i>
				Users
			</a> <a href="/admin/products"> <i class="bi bi-box-seam"></i>
				Products
			</a> <a href="/admin/orders"> <i class="bi bi-receipt"></i> Orders
			</a> <a href="/logout" class="logout"> <i
				class="bi bi-box-arrow-right"></i> Logout
			</a>
		</div>

		<!-- CONTENT -->
		<div class="content">

			<div class="d-flex justify-content-between mb-3">
				<h3>Manage Users</h3>
				<button class="btn btn-danger" data-bs-toggle="modal"
					data-bs-target="#addAdminModal">
					<i class="bi bi-person-plus"></i> Add Admin
				</button>
			</div>

			<!-- SEARCH -->
			<form method="get" action="/admin/users"
				class="mb-3 search-box d-flex gap-2">
				<input type="text" name="search" th:value="${search}"
					class="form-control" placeholder="Search by username" />
				<button class="btn btn-primary">Search</button>
			</form>

			<div class="table-responsive">
				<table class="table table-bordered align-middle">
					<thead>
						<tr>
							<th><a
								th:href="@{/admin/users(page=0,sort='userId',dir=${sort=='userId' && dir=='asc' ? 'desc' : 'asc'},search=${search})}">User
									ID</a></th>
							<th><a
								th:href="@{/admin/users(page=0,sort='username',dir=${sort=='username' && dir=='asc' ? 'desc' : 'asc'},search=${search})}">Username</a></th>
							<th><a
								th:href="@{/admin/users(page=0,sort='email',dir=${sort=='email' && dir=='asc' ? 'desc' : 'asc'},search=${search})}">Email</a></th>
							<th><a
								th:href="@{/admin/users(page=0,sort='role',dir=${sort=='role' && dir=='asc' ? 'desc' : 'asc'},search=${search})}">Role</a></th>
						</tr>
					</thead>

					<tbody>
						<tr th:each="user : ${users}">
							<td th:text="${user.userId}"></td>
							<td th:text="${user.username}"></td>
							<td th:text="${user.email}"></td>
							<td><span class="badge bg-secondary" th:text="${user.role}"></span>
							</td>
						</tr>
					</tbody>
				</table>
			</div>

			<!-- PAGINATION -->
			<div class="d-flex justify-content-between align-items-center mt-3">
				<div>
					<span
						th:text="'Showing ' + ${userPage.number * userPage.size + 1} + ' - ' + ${userPage.number * userPage.size + userPage.numberOfElements} + ' of ' + ${userPage.totalElements}"></span>
				</div>
				<nav>
					<ul class="pagination mb-0">
						<li class="page-item"
							th:classappend="${userPage.first} ? 'disabled'"><a
							class="page-link"
							th:href="@{/admin/users(page=${userPage.number-1},sort=${sort},dir=${dir},search=${search})}">Previous</a>
						</li>
						<li class="page-item"
							th:each="i : ${#numbers.sequence(0, userPage.totalPages-1)}"
							th:classappend="${userPage.number==i} ? 'active'"><a
							class="page-link"
							th:href="@{/admin/users(page=${i},sort=${sort},dir=${dir},search=${search})}"
							th:text="${i+1}"></a></li>
						<li class="page-item"
							th:classappend="${userPage.last} ? 'disabled'"><a
							class="page-link"
							th:href="@{/admin/users(page=${userPage.number+1},sort=${sort},dir=${dir},search=${search})}">Next</a>
						</li>
					</ul>
				</nav>
			</div>

		</div>
	</div>
	<!-- ADD ADMIN MODAL -->
<div class="modal fade" id="addAdminModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">

            <form method="post" th:action="@{/admin/users/add-admin}">

                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">Create New Admin</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">

                    <div class="mb-3">
                        <label class="form-label">Username</label>
                        <input type="text" name="username" class="form-control" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="email" name="email" class="form-control" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Password</label>
                        <input type="password" name="password" class="form-control" required>
                    </div>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger w-100">
                        Create Admin
                    </button>
                </div>

            </form>

        </div>
    </div>
</div>
	
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
